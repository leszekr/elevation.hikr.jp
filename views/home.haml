%section.bck.darkest.text.color.white
  .row.bkg-japan
    .column_6
      %h3 <br> Add elevation information to GeoJSON.<sup>*</sup>
      <br><br>
      You can drop a GeoJSON file to this page. You'll get your original GeoJSON data with elevation added to all point, path and polygon coordinates.
      <br><br>
      %small * Currently only Japan is supported.
    .column_6
      %form#dropForm{ :method=>'post'}
        %textarea#geojson{ :name=>'geojson', :placeholder=>"Paste GeoJSON data here." }
        %br
        %input.alert.on-right.button.large{ :type=>'submit', :value=>'Add elevation' }
        %br.clear
%section.bck.theme.padding
  .row
    .column_6
      %h2 Sign up for updates on Hikr
    .column_6.form.subscribe
      #mc_embed_signup
        %form{ :action=>"http://hikr.us7.list-manage.com/subscribe/post?u=ed00142426b464246887fc6d2&amp;id=cf8be08c43", :method=>"post", :id=>"mc-embedded-subscribe-form", :name=>"mc-embedded-subscribe-form", :class=>"validate", :target=>"_blank", :novalidate=>true }
          %fieldset
            %input.large.email{ :placeholder=>"Your e-mail address", :type=>"email", :value=>"", :name=>"EMAIL", :class=>"required email", :id=>"mce-EMAIL"}
            %button.button.large.alert.icon.envelope{ :type=>"submit", :value=>"Subscribe", :name=>"subscribe" }
%section.bck.lighter.padding
  .row
    .column_4
      %h4.margin-bottom Why?
      %p I store my hiking courses in GeoJSON files and no elevation service I could find allowed me to easily 
    .column_4
      %h4.margin-bottom What is Hikr?
      %p Hikr is an upcoming service for people who like hiking. <super>*</super>

      %br
      %br
      %small * Available in Japan at first.
    .column_4
      %h4.margin-bottom What is GeoJSON<br> and where can I get some?
      %p <a href="http://www.geojson.org/" target="_blank">GeoJSON</a> is one of several formats of storing geographical information. Think of it as computer instructions on how to draw a map with points of interest, paths and areas.
      %p You can make your own GeoJSON files using the wonderful <a href="http://geojson.io" target="_blank">geojson.io</a> service from <a href="http://mapbox.com" target="_blank">MapBox</a>.
%footer.bck.dark.padding
  .row.margin-top.margin-bottom
    .column_4
      &copy; 2013 Hikr.jp
    .column_8.text.right
      %a.icon.twitter{ :href=>"https://twitter.com/hikr_jp", :target=>"_blank" }
:javascript
  function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.
    var reader = new FileReader();  
    reader.onload = function(event) {            
         document.getElementById('geojson').value = event.target.result;
    }        
    reader.readAsText(files[0],"UTF-8");
  }

  function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
  }

  // Setup the dnd listeners.
  var dropZone = document.getElementsByTagName('body')[0];
  dropZone.addEventListener('dragover', handleDragOver, false);
  dropZone.addEventListener('drop', handleFileSelect, false);